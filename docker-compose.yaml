version: "3.9"

services:
  simulation:
    image: registry.gitlab.com/polytechnique-montr-al/inf3995/20213/equipe-100/inf3995-simulation/simulation:1.0.1
    privileged: true
    networks:
      - exploration
    environment:
      - DISPLAY
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix

  database:
    image: postgres:14-alpine
    networks:
      - exploration
    ports:
      - 5432:5432
    environment:
      - POSTGRES_PASSWORD=GOEXPLORE

  backend:
    image: registry.gitlab.com/polytechnique-montr-al/inf3995/20213/equipe-100/inf3995-backend/backend:0.10.0
    networks:
      - exploration
    ports:
      - 8000:8000
    environment:
      - ARGOS_DRONES_STARTING_PORT=3995
      - ARGOS_NUMBER_OF_DRONES=2
      - ARGOS_ENDPOINT=simulation
    devices:
      - /dev/bus/usb:/dev/bus/usb
    depends_on:
      - database
      - simulation

  client:
    image: registry.gitlab.com/polytechnique-montr-al/inf3995/20213/equipe-100/inf3995-client/client:1.1.7
    networks:
      - exploration
    ports:
      - 8080:8080
    depends_on:
      - backend

networks:
  exploration: